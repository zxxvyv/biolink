<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>zxxvyv</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="gengar.ico">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="enter-screen">
    <div id="enter-text">click to enter</div>
</div>

<audio id="audio">
    <source src="music.mp3" type="audio/mpeg">
</audio>

<div class="background">
    <img src="background.gif" class="background-gif" alt="background">
</div>

<main class="layout">

    <div class="card profile-card">
        <div class="pfp">
            <img src="pfp.gif" alt="pfp">
        </div>

        <div class="username">
            <span class="username-text">zxxvyv</span>
        </div>

        <div class="description">
            <span class="description-text">life is roblox</span>
        </div>

        <div class="social-buttons">
            <a href="https://github.com/zxxvyv" target="_blank"><i class="fab fa-github"></i></a>
            <a href="https://web.telegram.org/k/#@JudenVergaser88" target="_blank"><i class="fab fa-telegram"></i></a>
            <a href="https://www.instagram.com/084.marius" target="_blank"><i class="fab fa-instagram"></i></a>
        </div>
    </div>

    <div class="row">
        <div class="card small-card">
            <a href="https://www.youtube.com/@gothb0icl1qu3" class="mini-button" target="_blank">
                <i class="fab fa-youtube"></i><span>YouTube</span>
            </a>
        </div>

        <div class="card small-card">
            <a href="https://www.tiktok.com/@084.marius" class="mini-button" target="_blank">
                <i class="fab fa-tiktok"></i><span>TikTok</span>
            </a>
        </div>
    </div>

    <a href="https://www.tiktok.com/@084.marius" class="card big-button" target="_blank">
        <img src="spin-haunter.gif" class="card-gif">
        <span class="card-text">Best GeoGuessr Script</span>
        <img src="spin-haunter.gif" class="card-gif">
    </a>

    <div class="card">
        <div class="discord-widget">
            <div class="avatar-wrapper">
                <img id="discord-avatar" src="">
                <span id="status-dot"></span>
            </div>
            <div class="discord-info">
                <span id="status-text">Loading</span>
            </div>
        </div>
    </div>

    <div class="card">
        <div class="music-player">
            <span class="track-left">Lass alles fallen - Beyazz</span>
            <button id="playBtn"><i class="fa-solid fa-play"></i></button>
        </div>
    </div>

</main>

<script>
const splash = document.getElementById('enter-screen');
const splashText = document.getElementById('enter-text');

document.addEventListener("DOMContentLoaded", () => {

    const splash = document.getElementById("enter-screen");
    const splashText = document.getElementById("enter-text");

    const audio = document.getElementById("audio");
    const playBtn = document.getElementById("playBtn");
    const icon = playBtn.querySelector("i");

    audio.volume = 0.5;

    splash.addEventListener("click", () => {
        splashText.style.opacity = "0";
        splash.style.opacity = "0";

        setTimeout(() => {
            splash.style.display = "none";
        }, 500);

        audio.play();
        icon.classList.replace("fa-play", "fa-pause");
    });

    playBtn.addEventListener("click", () => {
        if (audio.paused) {
            audio.play();
            icon.classList.replace("fa-play", "fa-pause");
        } else {
            audio.pause();
            icon.classList.replace("fa-pause", "fa-play");
        }
    });

});

function formatDuration(startTimestamp) {
    const now = Date.now();
    const elapsed = now - startTimestamp;
    const seconds = Math.floor((elapsed / 1000) % 60);
    const minutes = Math.floor((elapsed / 1000 / 60) % 60);
    const hours = Math.floor(elapsed / 1000 / 60 / 60);

    if (hours > 0) {
        return `${hours}h ${minutes}m`;
    } else if (minutes > 0) {
        return `${minutes}m ${seconds}s`;
    } else {
        return `${seconds}s`;
    }
}

const statusColors = {
    online: 'green',
    idle: 'orange',
    dnd: 'red',
    offline: 'gray'
};

async function fetchDiscordWidget() {
    try {
        const res = await fetch('https://api.lanyard.rest/v1/users/957071564300501042');
        const data = await res.json();
        const user = data.data;

        document.getElementById('discord-avatar').src = user.discord_user.avatar='pfp.gif';

        const status = user.discord_status;
        document.getElementById('status-dot').style.backgroundColor = statusColors[status] || 'gray';

        let text = '';
        const game = user.activities.find(a => a.type === 0);
        const spotify = user.activities.find(a => a.type === 2);

        if (game) {
            text = `playing \n ${game.name}`;
            if (game.timestamps && game.timestamps.start) {
            text += ` - ${formatDuration(game.timestamps.start)}`;
        }   
        } else if (spotify) {
            text = `listening to \n ${spotify.details} - ${spotify.state}`;
        } else {
            text = status.charAt(0).toUpperCase() + status.slice(1);
        }

        document.getElementById('status-text').innerText = text;

    } catch (err) {
        document.getElementById('discord-avatar').src = 'pfp.gif';
        document.getElementById('status-dot').style.backgroundColor = 'gray';
        document.getElementById('status-text').innerText = 'Offline';
        console.error(err);
    }
}

setInterval(fetchDiscordWidget, 15000);
fetchDiscordWidget();
</script>

</body>
</html>